BÆ°á»›c 1: ÄÄƒng kÃ½ má»™t tÃ i khoáº£n bÃ¬nh thÆ°á»ng
Cháº¡y á»©ng dá»¥ng cá»§a báº¡n (python run.py).
Má»Ÿ trÃ¬nh duyá»‡t vÃ  truy cáº­p vÃ o trang web.
Nháº¥n vÃ o nÃºt "ÄÄƒng kÃ½" vÃ  táº¡o má»™t tÃ i khoáº£n má»›i (vÃ­ dá»¥: tÃªn Ä‘Äƒng nháº­p admin, email caobathien01112004@gmail.com vÃ  má»™t máº­t kháº©u an toÃ n).
Sau khi Ä‘Äƒng kÃ½ xong, báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p thá»­ Ä‘á»ƒ Ä‘áº£m báº£o tÃ i khoáº£n hoáº¡t Ä‘á»™ng. Hiá»‡n táº¡i, nÃ³ váº«n lÃ  má»™t tÃ i khoáº£n user thÆ°á»ng.
BÆ°á»›c 2: Sá»­ dá»¥ng flask shell Ä‘á»ƒ nÃ¢ng cáº¥p quyá»n
Dá»«ng server Ä‘ang cháº¡y báº±ng cÃ¡ch nháº¥n Ctrl + C trong terminal.
Äáº£m báº£o ráº±ng mÃ´i trÆ°á»ng áº£o cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t.
Trong terminal, táº¡i thÆ° má»¥c gá»‘c cá»§a dá»± Ã¡n (STUDENT_MANAGER), gÃµ lá»‡nh sau vÃ  nháº¥n Enter:
Bash
flask shell
Lá»‡nh nÃ y sáº½ má»Ÿ má»™t mÃ´i trÆ°á»ng Python tÆ°Æ¡ng tÃ¡c Ä‘Ã£ Ä‘Æ°á»£c káº¿t ná»‘i sáºµn vá»›i á»©ng dá»¥ng cá»§a báº¡n.
BÃ¢y giá», hÃ£y gÃµ láº§n lÆ°á»£t tá»«ng dÃ²ng lá»‡nh sau vÃ o shell. Nhá»› thay caobathien01112004@gmail.com báº±ng email báº¡n Ä‘Ã£ Ä‘Äƒng kÃ½ á»Ÿ BÆ°á»›c 1.
Import cÃ¡c module cáº§n thiáº¿t:
Python
from app import db
from app.models.user import User
TÃ¬m tÃ i khoáº£n ngÆ°á»i dÃ¹ng báº¡n vá»«a táº¡o:
Python
user = User.query.filter_by(email='caobathien01112004@gmail.com').first()
Kiá»ƒm tra xem Ä‘Ã£ tÃ¬m tháº¥y user chÆ°a (tÃ¹y chá»n):
Python
print(user) 
(Báº¡n sáº½ tháº¥y thÃ´ng tin user hiá»‡n ra, vÃ­ dá»¥: User('admin', 'caobathien01112004@gmail.com', 'user'))
NÃ¢ng cáº¥p vai trÃ² cá»§a user thÃ nh 'admin':
Python
user.role = 'admin'
LÆ°u thay Ä‘á»•i vÃ o database:
Python
db.session.commit()
Kiá»ƒm tra láº¡i láº§n ná»¯a (tÃ¹y chá»n):
Python
print(user)
(BÃ¢y giá» báº¡n sáº½ tháº¥y vai trÃ² Ä‘Ã£ Ä‘á»•i: User('admin', 'caobathien01112004@gmail.com', 'admin'))
ThoÃ¡t khá»i shell:
Python
exit()

# upload lÃªn github
git add .
git commit -m "Initial commit"
git branch -M main
git push -u origin main

#push lÃªn pythonanywhere.com dá»± Ã¡n cá»§a tÃ´i
git clone https://github.com/caobathien/student_manager.git

#uploadDB
ğŸ§© BÆ°á»›c 1. CÃ i thÆ° viá»‡n

KÃ­ch hoáº¡t virtualenv (náº¿u chÆ°a):

source ~/Church/venv/bin/activate


Sau Ä‘Ã³ cÃ i:

pip install flask-migrate

âš™ï¸ BÆ°á»›c 2. ThÃªm cáº¥u hÃ¬nh vÃ o app/__init__.py

Má»Ÿ file app/__init__.py vÃ  thÃªm dÃ²ng sau á»Ÿ Ä‘áº§u pháº§n import:

from flask_migrate import Migrate


Sau khi khá»Ÿi táº¡o db = SQLAlchemy(), thÃªm:

migrate = Migrate()


Trong hÃ m create_app(), ngay sau db.init_app(app):

db.init_app(app)
migrate.init_app(app, db)


VÃ­ dá»¥:

db.init_app(app)
migrate.init_app(app, db)
bcrypt.init_app(app)
login_manager.init_app(app)

ğŸ§± BÆ°á»›c 3. Táº¡o file cháº¡y lá»‡nh migrate

Táº¡o file má»›i á»Ÿ thÆ° má»¥c gá»‘c project, Ä‘áº·t tÃªn lÃ  manage.py:

from app import create_app, db
from flask_migrate import MigrateCommand, Migrate
from flask_script import Manager

app = create_app()
migrate = Migrate(app, db)
manager = Manager(app)

@manager.command
def hello():
    print("Flask-Migrate is ready!")

if __name__ == "__main__":
    manager.run()


(Náº¿u báº¡n khÃ´ng muá»‘n dÃ¹ng flask_script, cÃ³ thá»ƒ dÃ¹ng CLI cá»§a Flask luÃ´n â€” mÃ¬nh sáº½ chá»‰ á»Ÿ bÆ°á»›c 4).

ğŸ§­ BÆ°á»›c 4. Khá»Ÿi táº¡o migration folder (chá»‰ cáº§n 1 láº§n)

Cháº¡y trong terminal (váº«n trong mÃ´i trÆ°á»ng áº£o):

cd ~/Church
flask db init


LÃºc nÃ y sáº½ xuáº¥t hiá»‡n thÆ° má»¥c migrations/ trong project cá»§a báº¡n.

ğŸ” BÆ°á»›c 5. Khi báº¡n thay Ä‘á»•i model

Giáº£ sá»­ báº¡n thÃªm 1 cá»™t má»›i trong app/models/student.py, vÃ­ dá»¥:

new_field = db.Column(db.String(100))


ThÃ¬ báº¡n chá»‰ cáº§n cháº¡y:

flask db migrate -m "add new_field to student"
flask db upgrade


âœ… Flask-Migrate sáº½ tá»± Ä‘á»™ng táº¡o script SQL vÃ  Ã¡p dá»¥ng vÃ o MySQL
â¡ï¸ KhÃ´ng máº¥t dá»¯ liá»‡u cÅ©, cá»±c ká»³ an toÃ n.

ğŸ§¹ BÆ°á»›c 6. (TÃ¹y chá»n) â€” Kiá»ƒm tra log migration

Náº¿u báº¡n muá»‘n xem lá»‹ch sá»­ cÃ¡c láº§n migrate:

flask db history

ğŸ¯ Kiá»ƒm tra hoáº¡t Ä‘á»™ng

Sau khi cháº¡y xong flask db upgrade, hÃ£y má»Ÿ MySQL console:

USE ThienCao$ChurchDB;
DESCRIBE student;


â†’ Báº¡n sáº½ tháº¥y cá»™t má»›i vá»«a Ä‘Æ°á»£c thÃªm, mÃ  dá»¯ liá»‡u cÅ© váº«n nguyÃªn váº¹n ğŸ’ª
