{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/announcement.css') }}">

<div class="announcement-container">
    <div class="announcement-card">
        <h2 class="announcement-title"><i class="fas fa-bullhorn"></i> Tạo thông báo mới</h2>
        
        <form method="POST" action="" enctype="multipart/form-data">
            {{ form.hidden_tag() }}
            <fieldset class="form-group">

                <div class="form-group">
                    {{ form.title.label(class="form-label") }}
                    {{ form.title(class="form-control") }}
                </div>

                <div class="form-group">
                    {{ form.content.label(class="form-label") }}
                    {{ form.content(class="form-control", rows="8") }}
                </div>

                <div class="form-group">
                    {{ form.image.label(class="form-label") }}
                    {{ form.image(class="form-control-file", id="imageInput") }}
                    {% if form.image.errors %}
                        {% for error in form.image.errors %}
                            <span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                    {% endif %}
                    <div class="image-preview mt-3" id="imagePreview">
                        <span>Chưa chọn ảnh</span>
                    </div>
                </div>
            </fieldset>

            <div class="form-group text-center mt-4">
                {{ form.submit(class="btn btn-save") }}
            </div>
        </form>
    </div>
</div>

<script>
    const imageInput = document.getElementById("imageInput");
    const imagePreview = document.getElementById("imagePreview");

    imageInput.addEventListener("change", function() {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            imagePreview.innerHTML = "";
            reader.addEventListener("load", function() {
                const img = document.createElement("img");
                img.src = this.result;
                img.alt = "Xem trước ảnh";
                img.classList.add("preview-img");
                imagePreview.appendChild(img);
            });
            reader.readAsDataURL(file);
        } else {
            imagePreview.innerHTML = "<span>Chưa chọn ảnh</span>";
        }
    });
</script>
{% endblock content %}